

from sage.all import *
from ast import literal_eval

# ###############################################################################
#     Loading parameters needed to run the hash function at each security level  
# ###############################################################################


def load(secp, optimal):
    if secp == '128':
        e = 75
        p = 5*2**4*3**e-1
        Fp2 = GF((p,2), name='z2', modulus=var('x')**2 + 1)
        l = ceil(log(3**e, 2)) + 1
        
        Fp2.inject_variables()
        K = [[Fp2(31686932248522568585099010551058246465*z2 +35520209765133275254634260044078574569), Fp2(20331847229163256069377052247152064943*z2 + 3306988340664736660887945659699987863), Fp2(22586265731572579411462439905328603410*z2 + 41030671852390707390145502087579990483), Fp2(22236804450089770444608186179282207377*z2 + 26194855615263923747845216317273305162)], [Fp2(3098710989611319931233055364401186926*z2 + 8444121715157197025460480040936705785), Fp2(29999998035773188660322103762422128620*z2 + 32384036501083423447454466561420274176), Fp2(26360190495763027781951331648627791275*z2 + 38681085635918623588927041545551618844), Fp2(1)],[Fp2(3125994806732072787997797909573767602*z2 + 3727608937064124124347276817457540905),Fp2(27123413076082936159906870415209176647*z2 + 3822346034488668488265751226425806907),Fp2(11559178644001289007523643502461966777*z2 + 25887153711927930733735842280933304298),Fp2(9573805690821319016979766594414593065*z2 + 36677350664177300915233678144733447326)],[Fp2(20355445429154945449818840843682710260*z2 + 45096551795483903327109610645241028403),Fp2(34790360785908048362336283016694159572*z2 + 40625599886475017540943283583583676988),Fp2(20418640220495032486644558574555145811*z2 + 3968215743907707110495864410374407492),Fp2(6216465592971928683452921609852818200*z2 + 13262395051421026286921225941348402289)]]
        gens = [[ [Fp2(43747157381526401710080290936648948612*z2 + 26241717368541231167805856286859667276), Fp2(6561135426902168995707978978450755745*z2 + 38174863830396770118023824115912973193), Fp2(13083296322870436186946623529863302654*z2 + 36420878148855316611746219478328071779), Fp2(1)], [Fp2(26017848369273854891534564300429894827*z2 + 36676818428536422344233566583202052022), Fp2(28993018911095840603081894886567061672*z2 + 17673942823181231305690266927363793938), Fp2(8085086699375893122321945787696078887*z2 + 42168835235905053170324077551001091713), Fp2(1)], [Fp2(43747157381526401710080290936648948612*z2 + 26241717368541231167805856286859667276), Fp2(6561135426902168995707978978450755745*z2 + 38174863830396770118023824115912973193), Fp2(13083296322870436186946623529863302654*z2 + 36420878148855316611746219478328071779), Fp2(1)], [Fp2(3842532230009761877442210281735915931*z2 + 47249715520067245778288080852723646794), Fp2(27111426523207847252382198305655395120*z2 + 32887728851243603485101244367333217676), Fp2(30147596569302746221026570453015264389*z2 + 42400348373172067630466049051193399804), Fp2(1)]], [[Fp2(22362523227295494999487613254003371191*z2 + 40324036105970123323865554966269640783), Fp2(19097807297855281054843266975939185485*z2 + 36920903781299606407277564548234895954), Fp2(29113494440851253582105957068553116944*z2 + 20474262318025172976017838934192316634), Fp2(1)], [Fp2(26870744238559105342132957197406495709*z2 + 19998193979596866026292131503514428424), Fp2(30141947869442169880436854389572896440*z2 + 40154269880464781424633114172934444344), Fp2(41823262077358134478750394186982133733*z2 + 41895260031237614229006255260418284212), Fp2(1)], [Fp2(43747157381526401710080290936648948612*z2 + 26241717368541231167805856286859667276), Fp2(6561135426902168995707978978450755745*z2 + 38174863830396770118023824115912973193), Fp2(13083296322870436186946623529863302654*z2 + 36420878148855316611746219478328071779), Fp2(1)], [Fp2(19862228011425530645938514302151448461*z2 + 3638489084140708302869569620581329901), Fp2(26026975246392674674673048288965569571*z2 + 27741450623886400516348391167634783481), Fp2(44573389521525192055180000909231628416*z2 + 41299206594704359234786361275550404530), Fp2(1)]], [[Fp2(9299738932542353338788903268498215441*z2 + 27956851874165671667079999146930684914), Fp2(16830568136788711975715135717388963307*z2 + 27364667912166024359752791157929144521), Fp2(38563834563589741937609295599229369650*z2 + 415114702101804947016660138194379464), Fp2(1)], [Fp2(43075515735002863895750856201320654402*z2 + 44842973665826720204050911871946037872), Fp2(48127896063334150900720020402989950222*z2 + 22980761225138136490472104424749135071), Fp2(18750804503107512071116912653261147139*z2 + 48502986806082208230227580378621634646), Fp2(1)], [Fp2(9113146088277712276646924802052797323*z2 + 33681872308926658638483635106779220144), Fp2(499400009144705979755811831967409691*z2 + 23983709393797865637103575835004260990), Fp2(27020190739278148048324249485453325383*z2 + 47496133113531672895729379330584820099), Fp2(1) ], [ Fp2(38483494412534343298348956490073431959*z2 + 33555590153458334073131057773926404705), Fp2(15481202737615192664609837620256821618*z2 + 25343910588037069769551763119916790045), Fp2(81101214784840708460655125284269818*z2 + 22216438390931196498949677552471430486), Fp2(1)]], [[Fp2(43747157381526401710080290936648948612*z2 + 26241717368541231167805856286859667276), Fp2(6561135426902168995707978978450755745*z2 + 38174863830396770118023824115912973193), Fp2(13083296322870436186946623529863302654*z2 + 36420878148855316611746219478328071779), Fp2(1)], [Fp2(26017848369273854891534564300429894827*z2 + 36676818428536422344233566583202052022), Fp2(28993018911095840603081894886567061672*z2 + 17673942823181231305690266927363793938), Fp2(8085086699375893122321945787696078887*z2 + 42168835235905053170324077551001091713), Fp2(1)], [ Fp2(43747157381526401710080290936648948612*z2 + 26241717368541231167805856286859667276), Fp2(6561135426902168995707978978450755745*z2 + 38174863830396770118023824115912973193), Fp2(13083296322870436186946623529863302654*z2 + 36420878148855316611746219478328071779), Fp2(1) ], [ Fp2(21779184616727075324068541941612981108*z2 + 31551044688319565221916094077536904921), Fp2(46941988125052022297776532058123313433*z2 + 15418922421218175479701741144137174261), Fp2(26471465297453118459706227409930981708*z2 + 47282439931860442100294431739326232259), Fp2(1)]], [[Fp2(22362523227295494999487613254003371191*z2 +  40324036105970123323865554966269640783), Fp2(19097807297855281054843266975939185485*z2 + 36920903781299606407277564548234895954), Fp2(29113494440851253582105957068553116944*z2 + 20474262318025172976017838934192316634), Fp2(1)], [Fp2(26870744238559105342132957197406495709*z2 + 19998193979596866026292131503514428424), Fp2(30141947869442169880436854389572896440*z2 + 40154269880464781424633114172934444344), Fp2(41823262077358134478750394186982133733*z2 + 41895260031237614229006255260418284212), Fp2(1)], [Fp2(43747157381526401710080290936648948612*z2 + 26241717368541231167805856286859667276), Fp2(6561135426902168995707978978450755745*z2 + 38174863830396770118023824115912973193), Fp2(13083296322870436186946623529863302654*z2 + 36420878148855316611746219478328071779), Fp2(1)], [Fp2(19862228011425530645938514302151448461*z2 + 3638489084140708302869569620581329901), Fp2(26026975246392674674673048288965569571*z2 + 27741450623886400516348391167634783481), Fp2(44573389521525192055180000909231628416*z2 + 41299206594704359234786361275550404530), Fp2(1)]], [[Fp2(30356713000005612104935196081413378723*z2 + 17542472505181092868334850177502789757), Fp2(48653043090066322640143666732190430874*z2 + 38378486272982754020204225830755803848), Fp2(3703745984028737183614272301420426595*z2 + 2658051042618291599552900801448028488), Fp2(1)], [Fp2(32582447945321890609541351757967323304*z2 + 10861373468359740100474335408141327740), Fp2(36699879744921546007246536007159593829*z2 + 48289509292958082487695371603241493752), Fp2(36268914632699322986150320586512316416*z2 + 32742407928187178786142235474921515350), Fp2(1)], [Fp2(9551389466914005203282214691842350763*z2 + 42778156791834635626221097329508057843), Fp2(17740819460993838887635184077163957791*z2 + 37402607879379951006698065677671139401), Fp2(33185057177805817166244480758217617*z2 + 34639045187697442882229511719566726281), Fp2(1)], [ Fp2(2666156295530671340435701844507070772*z2 + 26479509992039125835011500002766314023), Fp2(32398811296039949696975440197320164054*z2 + 11037391014527724186778187694631384751), Fp2(10013302137492149842497990041835234651*z2 + 4428308325185875008447085523942770545), Fp2(1)]]]

        if optimal:
            strategy = [ 0, 1, 1, 2, 2, 2, 3, 4, 4, 4, 4, 5, 5, 6, 7, 8, 8, 8, 8, 8, 9, 9, 9, 9, 10, 11, 12, 12, 13, 14, 15, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17, 17, 18, 19, 20, 21, 21, 21, 21, 21, 22, 23, 24, 25, 26, 27, 27, 28, 29, 30, 31, 32, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33 ]
    
    if secp == '192':
        e = 115
        p = 37*2**4*3**e-1
        Fp2 = GF((p,2), name='z2', modulus=var('x')**2 + 1)
        l = ceil(log(3**e, 2)) + 1
        
        Fp2.inject_variables()

        K = [
            [Fp2(2143365707512131625548481541494791671277397003451568077225*z2 + 1640762889189872748133586452500823238005062987004295576872),
            Fp2(3384424124152531124702711559695453209869799956729101623402*z2 + 1437045354495836548551312407804458333531429472342861841685),
            Fp2(505991040985789742519982564124642435296112829229784931194*z2 + 2197536787092924759465017113021238056669162431481777651068),
            Fp2(2644129362648307915216884727938480393346071397445642360049*z2 + 1758246594949217824815417158277750516740187653402822248764)
            ],
            [Fp2(203407700513639852270655006063109579965871453658989078292*z2 + 1394045218355978404783615299529443979378271226503064092002),
            Fp2(2426179325581650152269164583263966444791957641865618676836*z2 + 2122894590735883871012489637721179229225248713613291447957),
            Fp2(3319983387200550564802614719676528310861486369861451793591*z2 + 2709782916890541485848053028401296204662613668923369965590),
            Fp2(1)
            ],
            [Fp2(2325889772657614171076125196906630529710114340299398297825*z2 + 522298743349190112638783867981911926380034545333897454108),
            Fp2(3096448160155933464718565538688679472341281546692380786340*z2 + 3934391540159745702180354022449247809129290654095362346808),
            Fp2(4090362466060298329788064980250940942659642699797346575933*z2 + 1364778294567514477697798663557085412446197170400668731471),
            Fp2(2583397667594076309171840612013643184160203112910554349837*z2 + 4047378812265433796080335688319571815473655713231309458967)
            ],
            [Fp2(3845876715522380055813648378568559374301917345399476905445*z2 + 1371994450579567697136495196094437902986017715456989609337),
            Fp2(1359841965389615333749449756421483530376259490040899253046*z2 + 2795398025696002161088747253659737449659800353207222759269),
            Fp2(496593545000566507897144885457858753200697631042881884687*z2 + 1944164421049129316954214636569620433313888166213356019912),
            Fp2(725160353225705469581292439572868818484463057651908589434*z2 + 3264185938229388806250452665581262647227880942626792901738)
            ]
        ]

        gens = [[
        [
            Fp2(3059111779652527898333839941544930369967709510172993886444*z2 + 925657426120377610491504677137923505124932074435358013568),
            Fp2(2980809058454296902627078900780116806189095228301685298308*z2 + 3432237231847995444475997009861549810901885286817560821549),
            Fp2(995462354109678197105807353386077887495415751245688653545*z2 + 1927548512938941147481837522784332496852136496595867631368),
            Fp2(1)
        ],
        [ 
            Fp2(3229768071033321651461481811132481966600649325392559718602*z2 + 3212801823243680316424460650119693628695876941007409008035),
            Fp2(1295064289743233664301623603044341467187896651732402736102*z2 + 937690680377291998489501472940615413224522039795090905695),
            Fp2(2284970681443260805599265257403254401399441922369921834090*z2 + 2398163151221229261888092150759916000269326600272170787172),
            Fp2(1)
        ],
        [
            Fp2(3059111779652527898333839941544930369967709510172993886444*z2 + 925657426120377610491504677137923505124932074435358013568),
            Fp2(2980809058454296902627078900780116806189095228301685298308*z2 + 3432237231847995444475997009861549810901885286817560821549),
            Fp2(995462354109678197105807353386077887495415751245688653545*z2 + 1927548512938941147481837522784332496852136496595867631368),
            Fp2(1)
        ],
        [
            Fp2(3926542431148195720073169046246587724466502437600951398022*z2 + 148475958622425375784765106328673500086079810038810121091),
            Fp2(1919246636608272059869844002910251215575405978637141249506*z2 + 3227610451171815451964126144152372126572647148655295434409),
            Fp2(249954308951368844904502344583592741528408700457262367342*z2 + 1703937690182703423131159195400309544566611120177161803313),
            Fp2(1)
        ]
    ],
    [
        [
           Fp2( 31806122272771521821509434357962770217655003289375539139*z2 + 1020719658316342498347286503110742505967417215854384643316),
            Fp2(3130115839262647725148468775461877746900304883925282354478*z2 + 505111507603498707523063753765033348657300943396885453085),
            Fp2(4220572792076238695112607784691044216135509432729031297689*z2 + 210521633277575148927315881629447112886313269875222127189),
            Fp2(1)
        ],
        [
            Fp2(2541898670545323391018466696742857271388064086970879515442*z2 + 1058312625837977709634838840884875080817693628368747427569),
            Fp2(218759986458508666349438519622066986324977456810349181996*z2 + 3335457357539503791266662593941254062416870093901871995667),
            Fp2(3380645786301702838220372122696054960435726506343143038572*z2 + 3354712645107386616851623808842170336793174147440300290760),
            Fp2(1)
        ],
        [
            Fp2(3059111779652527898333839941544930369967709510172993886444*z2 + 925657426120377610491504677137923505124932074435358013568),
            Fp2(2980809058454296902627078900780116806189095228301685298308*z2 + 3432237231847995444475997009861549810901885286817560821549),
            Fp2(995462354109678197105807353386077887495415751245688653545*z2 + 1927548512938941147481837522784332496852136496595867631368),
            Fp2(1)
        ],
        [
            Fp2(2187191114987407597264844737302192212504130374335649016672*z2 + 3847150518186417441272940069955814813932425908079263797264),
            Fp2(1881495489518532156270013741037267273561963821880852849260*z2 + 850126828855343949069164281311480191554348089643106606951),
            Fp2(2086854345100576571107529479648806468537871266292849054213*z2 + 1202049725145808445189030869106846459271749360294017240142),
            Fp2(1)
        ]
    ],
    [
        [
            Fp2(1464776814189000011863861426887984716745062252062842610827*z2 + 3524787036470364652098248006865635670980904037259014207311),
            Fp2(3031070965504882977185936850766473760901841180865151334734*z2 + 13127078998957510162106560481129931830554719058083966906),
            Fp2(1340584273108151874159116603446036885634899623831694175107*z2 + 1416815417010847563189487197164230512137563777173228536319),
            Fp2(1)
        ],
        [
            Fp2(1171220875747440094487590363195390764837193296817013826379*z2 + 394544052146851110662477865457600116929217649321699053575),
            Fp2(514148830212342255720693841275757820409275704917360080435*z2 + 3485540997744661021682883371128605669864415130509736034089),
            Fp2(3568622752630274287433595314750706982939297909171827009862*z2 + 1644614964192940418102512034306237089908468705248427146529),
            Fp2(1)
        ],
        [
            Fp2(1195435283956845429029787872255546454012147629220540416182*z2 + 2990980524716838519908741487732592391270140665192245111521),
            Fp2(1026518457586852976664426654876662567659790942087189146026*z2 + 288994570992473794304335318936269696248452518294207217636),
            Fp2(2010549769585769972591224027103042061501445013431697504787*z2 + 4255208861198591634233255290260961792032991075601559394586),
            Fp2(1)
        ],
        [
            Fp2(3276008664847952510581170022466267313690866561590705122837*z2 + 3932819075431568462505513238170139608307333301310535607064),
            Fp2(3566730593154392288088681093758308143456887632770392500629*z2 + 1882854099581855935194131691041417935843653513207098391549),
            Fp2(2405420452546701762139649338318191125530585568565234938558*z2 + 1448758088436518822129038573266690221326946786792342384705),
            Fp2(1)
        ]
    ],
    [
        [
            Fp2(3059111779652527898333839941544930369967709510172993886444*z2 + 925657426120377610491504677137923505124932074435358013568),
            Fp2(2980809058454296902627078900780116806189095228301685298308*z2 + 3432237231847995444475997009861549810901885286817560821549),
            Fp2(995462354109678197105807353386077887495415751245688653545*z2 + 1927548512938941147481837522784332496852136496595867631368),
            Fp2(1)
        ],
        [
            Fp2(3229768071033321651461481811132481966600649325392559718602*z2 + 3212801823243680316424460650119693628695876941007409008035),
            Fp2(1295064289743233664301623603044341467187896651732402736102*z2 + 937690680377291998489501472940615413224522039795090905695),
            Fp2(2284970681443260805599265257403254401399441922369921834090*z2 + 2398163151221229261888092150759916000269326600272170787172),
            Fp2(1)
        ],
        [
            Fp2(3059111779652527898333839941544930369967709510172993886444*z2 + 925657426120377610491504677137923505124932074435358013568),
            Fp2(2980809058454296902627078900780116806189095228301685298308*z2 + 3432237231847995444475997009861549810901885286817560821549),
            Fp2(995462354109678197105807353386077887495415751245688653545*z2 + 1927548512938941147481837522784332496852136496595867631368),
            Fp2(1)
        ],
        [
            Fp2(981794237711585705231193519319833828701640042099256443710*z2 + 3062827575458372730467967476809436515599659793145226019091),
            Fp2(1727921657012238916780729053541300854207718061670845508880*z2 + 1761484412487969280309468367108718023235810745247500720365),
            Fp2(1909348839272520485308936192692796498070418395431345345895*z2 + 2795048716229248269408039901498031266972853105705182345932),
            Fp2(1)
        ]
    ],
    [
        [
            Fp2(31806122272771521821509434357962770217655003289375539139*z2 + 1020719658316342498347286503110742505967417215854384643316),
            Fp2(3130115839262647725148468775461877746900304883925282354478*z2 + 505111507603498707523063753765033348657300943396885453085),
            Fp2(4220572792076238695112607784691044216135509432729031297689*z2 + 210521633277575148927315881629447112886313269875222127189),
            Fp2(1)
        ],
        [
            Fp2(2541898670545323391018466696742857271388064086970879515442*z2 + 1058312625837977709634838840884875080817693628368747427569),
            Fp2(218759986458508666349438519622066986324977456810349181996*z2 + 3335457357539503791266662593941254062416870093901871995667),
            Fp2(3380645786301702838220372122696054960435726506343143038572*z2 + 3354712645107386616851623808842170336793174147440300290760),
            Fp2(1)
        ],
        [
            Fp2(3059111779652527898333839941544930369967709510172993886444*z2 + 925657426120377610491504677137923505124932074435358013568),
            Fp2(2980809058454296902627078900780116806189095228301685298308*z2 + 3432237231847995444475997009861549810901885286817560821549),
            Fp2(995462354109678197105807353386077887495415751245688653545*z2 + 1927548512938941147481837522784332496852136496595867631368),
            Fp2(1)
        ],
        [
            Fp2(2187191114987407597264844737302192212504130374335649016672*z2 + 3847150518186417441272940069955814813932425908079263797264),
            Fp2(1881495489518532156270013741037267273561963821880852849260*z2 + 850126828855343949069164281311480191554348089643106606951),
            Fp2(2086854345100576571107529479648806468537871266292849054213*z2 + 1202049725145808445189030869106846459271749360294017240142),
            Fp2(1)
        ]
    ],
    [
        [
            Fp2(1849487431020407940293029149225545791787708152625022733953*z2 + 2985899332553802239113027539872569697527974789100881206249),
            Fp2(2858653913922436632584094888469572150663740287136499090572*z2 + 3774620386970897770750509901981425855794861834486163917180),
            Fp2(2060062938212730598421213297508019270829287634936681633561*z2 + 2629648946619514793975895848475500107151871259450546248699),
            Fp2(1)
        ],
        [
            Fp2(2860565983812843577576654294588871949416101971161222110243*z2 + 4013729381187228642560234039716628666469097630235500710922),
            Fp2(2803089896613142158516418074432140027338177172044013844258*z2 + 494975485578536453027109687989363439776767819335928696553),
            Fp2(1139492814612029047608024384357329880045035124028650189315*z2 + 2787944220986914190058989143864295372213551193413001848030),
            Fp2(1)
        ],
        [
            Fp2(3077334454331946363204261739727522512657914056747519142446*z2 + 3482107582917103457268522599717880952429791658451506699094),
            Fp2(1520872220980316900898732540975529082828446909311176322364*z2 + 3285189531894080263845571007101660966802759862687750849666),
            Fp2(301129529489906756387432199900257297165639550752782883276*z2 + 2438261254448134896948503347414530453688240456450512850521),
            Fp2(1)
        ],
        [
            Fp2(3091960223236566406397480375599916605923199535310583580183*z2 + 1918993625164516168075916935048687176202942956543232017079),
            Fp2(335717806174151690331052604533285563739156070956684147336*z2 + 2014275304310485567610377847715320183759000952840304520672),
            Fp2(1155177964802283257584863438158429710113734040523304017775*z2 + 1391543630577539394387849381982051751068370153675360350493),
            Fp2(1)
        ]]]
        
        if optimal:
            strategy = [ 0, 1, 1, 2, 2, 2, 3, 4, 4, 4, 4, 5, 5, 6, 7, 8, 8, 8, 8, 8, 9, 9, 9, 9, 10, 11, 12, 12, 13, 14, 15, 16,
            16, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17, 17, 18, 19, 20, 21, 21, 21, 21, 21, 22, 23, 24, 25, 26, 27, 27, 28, 29, 30,
            31, 32, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 35, 36, 37, 38, 38, 38, 38, 38, 38, 38,
            38, 38, 38, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 48, 48, 48, 48, 48, 49, 50, 51, 52 ]

    if secp == '256':
        e = 154
        p = 11*2**4*3**e-1
        Fp2 = GF((p,2), name='z2', modulus=var('x')**2 + 1)
        l = ceil(log(3**e, 2)) + 1
        
        Fp2.inject_variables()

        K = [[ 
                Fp2(4678573165223611166191414910975215918572812371594782534368734734098854043250*z2 + 3559862502368578365552522304571798606597177138986167221301954321745296808594),
                Fp2(1168891729736991904617964593612110349543677529368332469956309163159443165679*z2 + 3496036551547830719473003209509888848005541236148240943572772597616458020749),
                Fp2(3513150309085340847966775316241562368993723653012959871656377420155937837368*z2 + 1428975378768802414359183390824148912311001803789399320273659753500928827733),
                Fp2(765549820659361255409456534613687821377447643832024375532439103727834159703*z2 +  302663991579393343299400685063454203756403489462106677032766179672939429920)],
            [
                Fp2(4728440471006727476411980691449015196753945522963513540097170067028163424282*z2 + 2975682847561313122753823497125564976831414612017703525326344552131550004465),
                Fp2(1912275635628200946118636771470748023768337058487598556154128441324436885624*z2 + 409943634060718811750565664263694979615588173441232627405268296247484493632),
                Fp2(2939637034561908365092371380929963557449521471002961848496246197232733133555*z2 + 2585644703907628889920691296400579329695586781197598242856848560500823021434),
                Fp2(1)
            ],
            [
                Fp2(2989240182966962120793451580150395602062346894173993381675540181681029450943*z2 + 821123245637948400503817026086539554489731710251796305306449503789678805534),
                Fp2(524656333525536573971620556687568905750075720237331119355505011011876013372*z2 + 1472971904140737513996669846893455841078625763016321106759218440474909316628),
                Fp2(934757315065130472932420346985980662104062871278597709061877624325296611861*z2 + 2851263903076952744168135190465178160164184086074907860054083788540451795458),
                Fp2(2193998835650933377115791302795369073395990228674377053191523968912644008378*z2 + 1202062492906888190655411613365535662839362884664345696942601335746648638777)
            ],
            [
                Fp2(22711984612165299136125357504629650704790737605859433632638949875846134909*z2 + 4742130888406383365777336495347378673720347101930370416738393922825891016053),
                Fp2(1671014632486752538846854387418584090400878897296125417343362485246338232749*z2 + 2622775453195299388001710749799444555300163036763271797764414028308186382564),
                Fp2(725867320153095997327350947013049951078916616694667937386086874634125372095*z2 + 614302281346236418203994586945310610853737414599070233157243342482936503055),
                Fp2(4102466614870542113706193000953856113731337093221477922613881963879882499832*z2 + 1390779655561713337667735390519423601110056541828448634899978397417656858240)]]

        gens  = [[[
                Fp2(1376165004756561603740770829870189568091493431017855879991415081237147058829*z2 + 3383403234953346697248612218377172566754572898737116734748175530796716929195),
                Fp2(5251197052186598050316164958198010179990807340215611953107899381033546554493*z2 + 4271070982020489328515856842163846295802530994948485691300078642078762706881),
                Fp2(4205134887131738643446151053215630478586093874592757369223417592173774611338*z2 + 419398855231993016000853453170725625267824980734585190272686533030262175528),
                Fp2(1)
            ],
            [
                Fp2(579542042162802426171269337201261848198430284505870725312883170834233769078*z2 + 3284199874658118879464206957717348524032981005043278841254843911624791009951),
                Fp2(1268462618879490146353874698849534030868791598684800480090618041561112746205*z2 + 347597719300960540983759918420584388158652467259259274325419871051338791193),
                Fp2(1734643308827829932157719097236236466478566507465493239720542272551214058298*z2 + 4543904932174135023345744927405083536417558223542090707528435738097589561127),
                Fp2(1)
            ],
            [
                Fp2(1376165004756561603740770829870189568091493431017855879991415081237147058829*z2 + 3383403234953346697248612218377172566754572898737116734748175530796716929195),
                Fp2(5251197052186598050316164958198010179990807340215611953107899381033546554493*z2 + 4271070982020489328515856842163846295802530994948485691300078642078762706881),
                Fp2(4205134887131738643446151053215630478586093874592757369223417592173774611338*z2 + 419398855231993016000853453170725625267824980734585190272686533030262175528),
                Fp2(1)
            ],
            [
                Fp2(3337585031555345890882835755788250462053308520185763832720645260063463321490*z2 + 1590686956663588970883439892586400700488284468840514339519425784963007511735),
                Fp2(2735415757125867036017179093101051174059589948421079092308272756924428551932*z2 + 4791790439569398153222619731674302975722205181758689769433696373387734833668),
                Fp2(1025976831964698157086923679099887432264110440297211457004193469021795663639*z2 + 775264868715446094460861599180104964863011775139658514671052071321997753472),
                Fp2(1)
            ]
        ],
        [
            [
                Fp2(2402699715807527817876207615593174001578653565623526101413771605423147458104*z2 + 1602843127732902996840267819872019677858607953874330820208017550442083336186),
                Fp2(4601314215453523505851448622647525847227914229723196503353108651300525741351*z2 +   3956060199207334519655988186514443483375660071806289996665401210877462956563),
                Fp2(555481850569623666570836305577974716567787949111205935056178210785825659402*z2 + 3281794457526505460600186757949746950953286356236360992580999443489652601000),
                Fp2(1)
            ],
            [
                Fp2(1059121558105515600067623917562695371015767451509100731750243190740436586427*z2 + 2182614500964731303717280740316428419125966574296894268487544228736313871123),
                Fp2(2409092033702131365372900195059307815278712252711444197689600554384687435245*z2 + 2159354380442234418476810953061388858328302521295385984471529209326945839887),
                Fp2(4433951931597968569783246981408666445287091950279615200708771823852134073350*z2 + 4581937421763010286377961722590943852049023291609391870600155898276688436986),
                Fp2(1)
            ],
            [
                Fp2(1376165004756561603740770829870189568091493431017855879991415081237147058829*z2 + 3383403234953346697248612218377172566754572898737116734748175530796716929195),
                Fp2(5251197052186598050316164958198010179990807340215611953107899381033546554493*z2 + 4271070982020489328515856842163846295802530994948485691300078642078762706881),
                Fp2(4205134887131738643446151053215630478586093874592757369223417592173774611338*z2 + 419398855231993016000853453170725625267824980734585190272686533030262175528),
                Fp2(1)
            ],
            [
                Fp2(1890195049319386690704749077065772158110473628633495112842003232998554544484*z2 + 1940255526088831934847187748036444519521651626661847144538641517165378127009),
                Fp2(5018231140808600906861282378948790826069368020236578373110242386447549163111*z2 + 5217599474025834315528741743115477805846170575096075382400659615380389506421),
                Fp2(482880093991762254685305430485857741131400263842069026364636666153524561441*z2 + 4396481595174018950590236416491555481129590749506565718137222745384656355412),
                Fp2(1)
            ]
        ],
        [
            [
                Fp2(2819816034898650915509185616137851176147419671826355395650250739575849196657*z2 + 2860973963808514676356886983206260766951004068529889260606030645674519286995),
                Fp2(4643266033902200849537812518374480922474388091842289586199526712445755109713*z2 + 857639089006072510600949398659602659032432153552617246651154979745302684975),
                Fp2(4818327881031252156311388744451694403210867455168505165565638189324669502818*z2 + 1298442250498623181299674034334431930541942291598565696658733325423110100764),
                Fp2(1)
            ],
            [
                Fp2(3398984025867712839554311915074929928404023834496605795001738389513015728588*z2 + 2083410544673137529206443450657486397962624375820018687519442985530568437981),
                Fp2(433005113009433846689277945607380387757901756239692361105500804012349775648*z2 + 994039392989882419282065683125295132839488870566584261301581965927164939833),
                Fp2(4055431348019736867095882740161030242224006861768520103326339821071442766238*z2 + 311371725937022209397417442282993277419960182785320306536029993696734601507),
                Fp2(1)
            ],
            [
                Fp2(2115942547790765113065214253932012376492180092928019572271680600340396795179*z2 + 1119022153013888492792138218496735954174201421587948038840506597127496767836),
                Fp2(5054344231127996585249158920060532010291068769294788372743279677362999124312*z2 + 1445648057395502196379563617219402099308164987691734451755542621933928420258),
                Fp2(4018836617846997318368053115625588070869420592769063788009194806178159953524*z2 + 348564340327122105629393541685339634845284047135877886828048955027578933034),
                Fp2(1)
            ],
            [
                Fp2(40928892459183116197260731660085605433609502597038279653683965625827359266*z2 + 2104527950182527082342868995175609648394234823644155791614641317025609275521),
                Fp2(2186115998679092983489670094552396553314054179588945149336245984577246120072*z2 + 3801352597513851776014113288011353956320169013427895964965707418990507769584),
                Fp2(1107983693527118667680533277439595501297556480226272512060134885496858265959*z2 + 1830684268024753563195185249087513898171240419829238072713051288408606459310),
                Fp2(1)
            ]
        ],
        [
            [
                Fp2(1376165004756561603740770829870189568091493431017855879991415081237147058829*z2 + 3383403234953346697248612218377172566754572898737116734748175530796716929195),
                Fp2(5251197052186598050316164958198010179990807340215611953107899381033546554493*z2 + 4271070982020489328515856842163846295802530994948485691300078642078762706881),
                Fp2(4205134887131738643446151053215630478586093874592757369223417592173774611338*z2 + 419398855231993016000853453170725625267824980734585190272686533030262175528),
                Fp2(1)
            ],
            [
                Fp2(579542042162802426171269337201261848198430284505870725312883170834233769078*z2 + 3284199874658118879464206957717348524032981005043278841254843911624791009951),
                Fp2(1268462618879490146353874698849534030868791598684800480090618041561112746205*z2 + 347597719300960540983759918420584388158652467259259274325419871051338791193),
                Fp2(1734643308827829932157719097236236466478566507465493239720542272551214058298*z2 + 4543904932174135023345744927405083536417558223542090707528435738097589561127),
                Fp2(1)
            ],
            [
                Fp2(1376165004756561603740770829870189568091493431017855879991415081237147058829*z2 + 3383403234953346697248612218377172566754572898737116734748175530796716929195),
                Fp2(5251197052186598050316164958198010179990807340215611953107899381033546554493*z2 + 4271070982020489328515856842163846295802530994948485691300078642078762706881),
                Fp2(4205134887131738643446151053215630478586093874592757369223417592173774611338*z2 + 419398855231993016000853453170725625267824980734585190272686533030262175528),
                Fp2(1)
            ],
            [
                Fp2(4671488941211165325888676846873503353964789026861377532337993564975260800509*z2 + 1995254382506563064787562508632910344013344251717825770894843800195199675419),
                Fp2(2380326243083638218879356411668695082791069230583555719054110709077598687804*z2 + 2318811102626135385896661607578063360227133086353714145073661437948897725334),
                Fp2(5230351477853289393398987082499619913228055672118597351381575498273901360502*z2 + 1065063473689411541878142296869922888293269669150003549371988551140084938645),
                Fp2(1)
            ]
        ],
        [
            [
                Fp2(2402699715807527817876207615593174001578653565623526101413771605423147458104*z2 + 1602843127732902996840267819872019677858607953874330820208017550442083336186),
                Fp2(4601314215453523505851448622647525847227914229723196503353108651300525741351*z2 + 3956060199207334519655988186514443483375660071806289996665401210877462956563),
                Fp2(555481850569623666570836305577974716567787949111205935056178210785825659402*z2 + 3281794457526505460600186757949746950953286356236360992580999443489652601000),
                Fp2(1)
            ],
            [
                Fp2(1059121558105515600067623917562695371015767451509100731750243190740436586427*z2 + 2182614500964731303717280740316428419125966574296894268487544228736313871123),
                Fp2(2409092033702131365372900195059307815278712252711444197689600554384687435245*z2 +  2159354380442234418476810953061388858328302521295385984471529209326945839887),
                Fp2(4433951931597968569783246981408666445287091950279615200708771823852134073350*z2 + 4581937421763010286377961722590943852049023291609391870600155898276688436986),
                Fp2(1)
            ],
            [
                Fp2(1376165004756561603740770829870189568091493431017855879991415081237147058829*z2 + 3383403234953346697248612218377172566754572898737116734748175530796716929195),
                Fp2(5251197052186598050316164958198010179990807340215611953107899381033546554493*z2 + 4271070982020489328515856842163846295802530994948485691300078642078762706881),
                Fp2(4205134887131738643446151053215630478586093874592757369223417592173774611338*z2 + 419398855231993016000853453170725625267824980734585190272686533030262175528),
                Fp2(1)
            ],
            [
                Fp2(1890195049319386690704749077065772158110473628633495112842003232998554544484*z2 +  1940255526088831934847187748036444519521651626661847144538641517165378127009),
                Fp2(5018231140808600906861282378948790826069368020236578373110242386447549163111*z2 + 5217599474025834315528741743115477805846170575096075382400659615380389506421),
                Fp2(482880093991762254685305430485857741131400263842069026364636666153524561441*z2 + 4396481595174018950590236416491555481129590749506565718137222745384656355412),
                Fp2(1)
            ]
        ],
        [
            [
                Fp2(2309449898050932790764264677287190515912353786853248695671772220723123402094*z2 + 4322310402093514649787862630312609151492064952335134707916247956836815215063),
                Fp2(3773086304467929731607311307130201109099692670398324283887554291582173369074*z2 + 5140708651846701400961756749304565968146295226194705259632722048900142188697),
                Fp2(3905215922358828177048350376945224475995570978785592996281267575104529084348*z2 + 2241759971756347929349144172885036649222422831716507912959122997209579060142),
                Fp2(1)
            ],
            [
                Fp2(3345121182207451967331392635428845444347067586233583785786928897336695943484*z2 + 639416381885561643194275847592447568904470606945588159729825465433530645133),
                Fp2(3265544183521374820653903088433938378874130364548929748967048903196423698972*z2 + 610823646136045341514420199794295462128023990735767428600954225632017189627),
                Fp2(5047365049411453345114728613623435572614919676737666950839763735281119599202*z2 + 1750076259066010527854005626666183627103576274269241800985300235686618245077),
                Fp2(1)
            ],
            [
                Fp2(3712621108319028318273110060185455196684435514886380303927987859878667469200*z2 + 4981362367644175455083132960662648410537684627576946941352672777094249425464),
                Fp2(3991961365981689382314841420527121943457468983786578209334865047303366409884*z2 + 2885894516054164860614867277034080356672977998096241430694503132557849199540),
                Fp2(368681719200054431852317033197244551255610250515080721461787720400455031871*z2 + 1749203727825771369848175209938940072684778238794837950740513883183436798556),
                Fp2(1)
            ],
            [
                Fp2(2262412930118687425476531336972862299151204943468042982844910671800330448046*z2 +4883713341859944739453521363856440528091684453420134674127664991799296069901),
                Fp2(2730243020712140427049981198343616756368724570624712653971619100624401293294*z2 + 4240477424121638069605761208129336966025480392803335717671528719795463162521),
                Fp2(2657323805484333079881571479195093024789148210843568011448273757499564895469*z2 + 3290788983319467477708567500871222071088851041988124210312304201079035206763),
                Fp2(1)
            ]]]
        
        if optimal:
            strategy = [ 0, 1, 1, 2, 2, 2, 3, 4, 4, 4, 4, 5, 5, 6, 7, 8, 8, 8, 8, 8, 9, 9, 9, 9, 10, 11, 12, 12, 13, 14, 15, 16,
            16, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17, 17, 18, 19, 20, 21, 21, 21, 21, 21, 22, 23, 24, 25, 26, 27, 27, 28, 29, 30,
            31, 32, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 35, 36, 37, 38, 38, 38, 38, 38, 38, 38,
            38, 38, 38, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 48, 48, 48, 48, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 58,
            59, 60, 61, 62, 63, 63, 64, 64, 64, 64, 64, 64, 64, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 66,
            67, 68 ]

    params = {}

    params['e'] = e
    params['p'] = p
    params['l'] = l
    params['Fp2'] = Fp2
    params['K'] = K
    params['gens'] = gens
    if optimal:
        params['strategy'] = strategy

    return params